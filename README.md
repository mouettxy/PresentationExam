### Надстройка для интерфейса OfficeAPI для проверки презентаций формата ОГЭ 2020 по информатике
Данное приложение включает в себя алгоритмы анализа и генерации картинок, а так же
настраиваемый конфиг для для макетов презентаций, констант, значений проверки.

#### Что необходимо для запуска
- Модули
    - pywin32
    - Pillow
    - imagehash
- Версия Python 3.7 или выше
- Презентации для которых необходимо получить анализ

#### Как получить анализ?
```python
from exam.analyze import Analyze
analyze = Analyze("C:/abspath/to/presentation.pptx").get("analyze")
``` 

#### Различные сниппеты кода

##### Работа с картинками
```python
from exam.analyze.images import Images

# Все картинки генерируются в папке temp/presentation-name.pptx/
# Инициализируем обьект картинок, и даём ему абсолютный путь к презентации
images = Images("C:/abspath/to/presentation.pptx")

# Получить пути к сгенерированным картинкам скелета презентации. Учитываются только фактические размеры обьектов
# Для текста например будут обрезаны все отступы блока
skeleton = images.skeleton()

# Получить пути к сгенерированным картинкам макета презентации который описан в layouts.ini
# Параметр lt это имя блока в конфигурационном файле макетов
layout = images.layout(lt="LAYOUT_NAME")

# Получить пути к извлечённым картинкам изображений из презенатции, в API не используется нигде, т.к если изображение
# было обрезано, то прозрачные отступы появляются и в картинке
shape_images = images.get_shape_images()

# Оригинальные изображения из презентации, такого же размера и качества как и были загружены
original_images = images.save_original_images()

# Сравнить изображения в презентации с изображениями в папке которая передаётся в параметр path, путь может быть
# абсолютным или относительным. Отдаст булево значение Совпадает/Не совпадает. Ищется по такому принципу,
# если количество картинок в презентации == совпавшим картинкам, то изображения в презентации соответствуют данным
compare = images.compare(path="abs/or/relative/path/to/folder/with/images")

# Проверить искажены ли изображения в презентации. Если хоть одно изображение искажено - вернёт True, в любом другом
# случае False
distorted = images.distorted_images()

# Скриншоты презентации
screenshots = images.get()

# Первый слайд презенатции уменьшенный до 200х200
thumb = images.get(thumb=True)
```

##### Различные полезные методы
```python
from exam.analyze import Analyze

# Инициализируем класс анализа
analyze = Analyze("C:/abspath/to/presentation.pptx")

# Предупреждения о возможных ошибках в презентации, такие как различные анимации на слайдах/объектах обрезка картинок
# или пустые элементы
warnings = analyze.warnings

# Экспортирует анализ в csv файл в стандартную папку Downloads
analyze.export_csv()
```
##### Работа с конфигом
Файл config.ini
```ini
[CONSTANTS]
; Значение верхнего угла обьекта при котором он не считается как находящийся в слайде
text out of bounds = -50 
; Экспериментальное значение которое добавляется сверху и слева, и отнимается снизу и справа, компенсирует отступы
text dimensions average = 7 

[ANALYZE]
; Параметры анализа, так же можно указать передав в функцию exam.config.modify_analyze() словарь с ключом/значением
; Количество слайдов небходимых в презентации
slides = 3
; Пропорциональность слайдов презентации
aspect_ratio = 16/9
; Количество текстовых блоков на 1,2,3 cлайдах (указывается ВМЕСТЕ с заголовками)
text_blocks_1 = 2
text_blocks_2 = 3
text_blocks_3 = 4
; Количество картинок на 1,2,3 слайдах
images_1 = 0
images_2 = 2
images_3 = 3
; Шрифты которые необходимы в презентации. Для каждого текстового блока float
; значение, первым всегда должен идти заголовок
font_sizes_1 = 40.0,24.0
font_sizes_2 = 24.0,20.0,20.0
font_sizes_3 = 24.0,20.0,20.0,20.0
```
Файл layouts.ini
```ini
; Имя секции - имя макета
; 4 значения обозначают левый угол, верхний угол, ширину, высоту блока в котором должен находиться элемент презентации
; цифровые значения это те значения на которые разделится либо ширина (w) либо высота (h) либо останется нулём (0-e)
; все значения указываются через запятую, где сначала идёт цифра, а потом к чему она относится, т.е высота/ширина/0
; Если необходимо разделить презентацию на больше чем 2 части, то можно использовать умножение
; В созданном макете тщательно прописано то как именно его видит программа
; для создания через python можно использовать функцию exam.config.add_layout()
; как именно ей передавть значения указно в ней же
; если необходимо сделать несколько разрозненных прямоугольников, можно использовать разделитель |
[DEFAULT]
; Заголовок на втором слайде
; Находится в 0-х координатах сверху и слева, и занимает полностью ширину и 1/4 часть высоты слайда
title_2 = 0-e,0-e,1-w,4-h
; Изображения на втором слайде
; Находится в 0-х координатах сверху и слева, и занимает 1/2 ширины и всю высоту слайда
images_2 = 0-e,0-e,2-w,1-h
; Текстовые блоки на втором слайде
; Находится слева на 1/2 части ширины слайда в самом верху, и занимает 1/2 ширины и всю высоту слайда
text_2 = 2-w,0-e,2-w,1-h 
; Заголовок на третьем слайде
; Находится в 0-х координатах сверху и слева, и занимает полностью ширину и 1/4 часть высоты слайда
title_3 = 0-e,0-e,1-w,4-h
; Картинки на третьем слайде
; Первая картинка находится в 0х координатах слева и сверху, и занимает 1/3 ширины и 1/2 высоты слайда
; Вторая картинка находится слева на 1/3 ширины слайда и сверху на 1/2 высоты слайда, и занимает 1/3 ширины и 1/2
;                                                                                                   высоты слайда
; Третья картинка находится слева на 1/3*2 ширины слайда и сверху на 0х координатах, занимает 1/3 ширины и 1/2
;                                                                                                высоты слайда
images_3 = 0-e,0-e,3-w,2-h|3-w,2-h,3-w,2-h|3*2-w,0-e,3-w,2-h
; Текстовые блоки на третьем слайде
; Первый находится в на 0й координате слева и 1/2 ширины слайда сверху, занимает 1/3 ширины и 1/2 высоты слайда
; Второй находится слева на 1/3 ширины, сверху на 0, занимает 1/3 ширины слайда и 1/2 высоты слайда
; Третий находится слева на 1/3*2 ширины слайда, сверху на 1/2 высоты слайда, занимает 1/3 ширины и 1|2 высоты слайда
text_3 = 0-e,2-h,3-w,2-h|3-w,0-e,3-w,2-h|3*2-w,2-h,3-w,2-h
```

#### Вопросы и предложения
Я всегда рад ответить на любые вопросы через почту lis@chaikovskie.com
О любых ошибках можно сообщать в issue на github или опять же в почту.